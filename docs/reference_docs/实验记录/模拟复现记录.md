# 模拟数据复现记录

## 数据准备
- 立方体文件：`data/processed/set_II/simulated_set_II_cube.npz`（102 颗油茶籽的 24×24×161 高光谱立方体与 ROI 掩膜）。
- ROI 均值光谱：`data/processed/set_II/mean_spectra.csv`。
- 波段：900–1 700 nm，步长 5 nm（列名 `wl_<波长>`），同时提供 `oil_content` 标签。
- 生成方式：基于多峰高斯光谱、随机椭圆 ROI 与像素级噪声模拟漫反射成像，再按 1200–1500 nm 吸收特征映射到 20–45% 的含油率。

## 复现流程（GA + PLSR）
1. 设置环境变量 `MKL_THREADING_LAYER=SEQUENTIAL`、`OMP_NUM_THREADS=1` 等，规避 OpenMP 共享内存限制。
2. 运行脚本：
   ```bash
   PYTHONPATH=src MKL_THREADING_LAYER=SEQUENTIAL \
   OMP_NUM_THREADS=1 OPENBLAS_NUM_THREADS=1 \
   MKL_NUM_THREADS=1 NUMEXPR_NUM_THREADS=1 \
   python scripts/run_best_method.py
   ```
3. 核心步骤：
   - 使用 `GeneticAlgorithmSelector`（群体 12、最大 10 代、交叉 0.85、突变 0.04、cv=3）在训练集上筛选目标 18 个特征波长。
   - 根据选择结果设定 PLSR 潜变量数 `min(10, n_features // 2)`，拟合训练集。
   - 评估训练/测试集 R²、RMSE，同时记录 GA 平均交叉验证得分。

## 本次运行结果
- 选择波长数：22（示例：[920, 955, 960, 1050, 1055, 1070, 1095, 1125, 1195, 1200, 1260, 1285, 1300, 1330, 1355, 1380, 1395, 1495, 1585, 1605, 1620, 1665] nm）。
- 训练集：R²=0.873，RMSE=0.946。
- 测试集：R²=0.613，RMSE=1.713。
- GA 交叉验证平均得分：约 0.753。

> 注：数据为模拟，指标仅用于验证代码通路与论文“光谱集Ⅱ + GA + PLSR”方案。实际实验需替换为实测光谱与索氏抽提含油率。
